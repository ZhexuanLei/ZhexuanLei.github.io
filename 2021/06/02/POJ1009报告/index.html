<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/logo.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/logo.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/logo.png">
  <link rel="mask-icon" href="/images/logo.png" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{&quot;hostname&quot;:&quot;zhexuanlei.github.io&quot;,&quot;root&quot;:&quot;&#x2F;&quot;,&quot;images&quot;:&quot;&#x2F;images&quot;,&quot;scheme&quot;:&quot;Gemini&quot;,&quot;version&quot;:&quot;8.5.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;display&quot;:&quot;post&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12},&quot;copycode&quot;:false,&quot;bookmark&quot;:{&quot;enable&quot;:false,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:false,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:false,&quot;pangu&quot;:false,&quot;comments&quot;:{&quot;style&quot;:&quot;tabs&quot;,&quot;active&quot;:&quot;valine&quot;,&quot;storage&quot;:true,&quot;lazyload&quot;:false,&quot;nav&quot;:null,&quot;activeClass&quot;:&quot;valine&quot;},&quot;motion&quot;:{&quot;enable&quot;:true,&quot;async&quot;:false,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;fadeInDown&quot;,&quot;post_body&quot;:&quot;fadeInDown&quot;,&quot;coll_header&quot;:&quot;fadeInLeft&quot;,&quot;sidebar&quot;:&quot;fadeInUp&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;搜索...&quot;,&quot;empty&quot;:&quot;没有找到任何搜索结果：${query}&quot;,&quot;hits_time&quot;:&quot;找到 ${hits} 个搜索结果（用时 ${time} 毫秒）&quot;,&quot;hits&quot;:&quot;找到 ${hits} 个搜索结果&quot;}}</script><script src="/js/config.js"></script>
<meta name="description" content="这是一篇关于北京大学在线评测机(PKU OJ)问题#1009的解题报告，讨论了相应的算法与解题思路，采用基于JDK 6的Java语言进行实现。点击这里查看原题。">
<meta property="og:type" content="article">
<meta property="og:title" content="POJ1009 解题报告">
<meta property="og:url" content="http://zhexuanlei.github.io/2021/06/02/POJ1009%E6%8A%A5%E5%91%8A/index.html">
<meta property="og:site_name" content="Marius&#39; Blog">
<meta property="og:description" content="这是一篇关于北京大学在线评测机(PKU OJ)问题#1009的解题报告，讨论了相应的算法与解题思路，采用基于JDK 6的Java语言进行实现。点击这里查看原题。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://poj.org/images/1009_1.jpg">
<meta property="article:published_time" content="2021-06-02T06:35:04.000Z">
<meta property="article:modified_time" content="2021-06-03T11:06:46.176Z">
<meta property="article:author" content="Marius">
<meta property="article:tag" content="POJ">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://poj.org/images/1009_1.jpg">


<link rel="canonical" href="http://zhexuanlei.github.io/2021/06/02/POJ1009%E6%8A%A5%E5%91%8A/">



<script class="next-config" data-name="page" type="application/json">{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:false,&quot;isPost&quot;:true,&quot;lang&quot;:&quot;zh-CN&quot;,&quot;comments&quot;:true,&quot;permalink&quot;:&quot;http:&#x2F;&#x2F;zhexuanlei.github.io&#x2F;2021&#x2F;06&#x2F;02&#x2F;POJ1009%E6%8A%A5%E5%91%8A&#x2F;&quot;,&quot;path&quot;:&quot;2021&#x2F;06&#x2F;02&#x2F;POJ1009报告&#x2F;&quot;,&quot;title&quot;:&quot;POJ1009 解题报告&quot;}</script>

<script class="next-config" data-name="calendar" type="application/json">&quot;&quot;</script>
<title>POJ1009 解题报告 | Marius' Blog</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Marius' Blog</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">小雷的博客</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%9F%E9%A2%98-Edge-Detection"><span class="nav-number">1.</span> <span class="nav-text">原题: Edge Detection</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Description"><span class="nav-number">1.1.</span> <span class="nav-text">Description</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Input"><span class="nav-number">1.2.</span> <span class="nav-text">Input</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Output"><span class="nav-number">1.3.</span> <span class="nav-text">Output</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Hint"><span class="nav-number">1.4.</span> <span class="nav-text">Hint</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%9F%E7%90%86%E4%B8%8E%E7%AE%97%E6%B3%95"><span class="nav-number">2.</span> <span class="nav-text">原理与算法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="nav-number">3.</span> <span class="nav-text">代码实现</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Marius"
      src="/images/Nanase.jpg">
  <p class="site-author-name" itemprop="name">Marius</p>
  <div class="site-description" itemprop="description">这辈子赶上谁都是九死一生，所以何不洒脱活着</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">2</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/ZhexuanLei" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ZhexuanLei" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/mariuszxlei@gmail.com" title="E-Mail → mariuszxlei@gmail.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://instagram.com/mariuszxlei" title="Instagram → https:&#x2F;&#x2F;instagram.com&#x2F;mariuszxlei" rel="noopener" target="_blank"><i class="fab fa-instagram fa-fw"></i>Instagram</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://space.bilibili.com/82725025" title="Bilibili → https:&#x2F;&#x2F;space.bilibili.com&#x2F;82725025" rel="noopener" target="_blank"><i class="fas fa-tv fa-fw"></i>Bilibili</a>
      </span>
  </div>


  <div class="links-of-blogroll site-overview-item animated">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      友情链接
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://nishinonanase.com/" title="https:&#x2F;&#x2F;nishinonanase.com" rel="noopener" target="_blank">Nanase</a>
        </li>
    </ul>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://zhexuanlei.github.io/2021/06/02/POJ1009%E6%8A%A5%E5%91%8A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/Nanase.jpg">
      <meta itemprop="name" content="Marius">
      <meta itemprop="description" content="这辈子赶上谁都是九死一生，所以何不洒脱活着">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Marius' Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          POJ1009 解题报告
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-06-02 14:35:04" itemprop="dateCreated datePublished" datetime="2021-06-02T14:35:04+08:00">2021-06-02</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-06-03 19:06:46" itemprop="dateModified" datetime="2021-06-03T19:06:46+08:00">2021-06-03</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">计算机科学</span></a>
        </span>
    </span>

  
    <span id="/2021/06/02/POJ1009%E6%8A%A5%E5%91%8A/" class="post-meta-item leancloud_visitors" data-flag-title="POJ1009 解题报告" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>6.9k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>6 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>这是一篇关于北京大学在线评测机(PKU OJ)问题#1009的解题报告，讨论了相应的算法与解题思路，采用基于JDK 6的Java语言进行实现。点击<a target="_blank" rel="noopener" href="http://poj.org/problem?id=1009">这里</a>查看原题。</p>
<span id="more"></span>
<h2 id="原题-Edge-Detection"><a href="#原题-Edge-Detection" class="headerlink" title="原题: Edge Detection"></a>原题: Edge Detection</h2><p><em>原题来自2000 ICPC Mid-Central USA编程竞赛</em></p>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>IONU Satellite Imaging, Inc. records and stores very large images using run length encoding. You are to write a program that reads a compressed image, finds the edges in the image, as described below, and outputs another compressed image of the detected edges.<br>A simple edge detection algorithm sets an output pixel’s value to be the maximum absolute value of the differences between it and all its surrounding pixels in the input image. Consider the input image below:<br><img src="http://poj.org/images/1009_1.jpg" alt="Example Input &amp; Output"><br>The upper left pixel in the output image is the maximum of the values |15-15|,|15-100|, and |15-100|, which is 85. The pixel in the 4th row, 2nd column is computed as the maximum of |175-100|, |175-100|, |175-100|, |175-175|, |175-25|, |175-175|,|175-175|, and |175-25|, which is 150.<br>Images contain 2 to 1,000,000,000 (109) pixels. All images are encoded using run length encoding (RLE). This is a sequence of pairs, containing pixel value (0-255) and run length (1-109). Input images have at most 1,000 of these pairs. Successive pairs have different pixel values. All lines in an image contain the same number of pixels.</p>
<h3 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h3><p>Input consists of information for one or more images. Each image starts with the width, in pixels, of each image line. This is followed by the RLE pairs, one pair per line. A line with 0 0 indicates the end of the data for that image. An image width of 0 indicates there are no more images to process. The first image in the example input encodes the 5x7 input image above.</p>
<h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><p>Output is a series of edge-detected images, in the same format as the input images, except that there may be more than 1,000 RLE pairs.</p>
<h3 id="Hint"><a href="#Hint" class="headerlink" title="Hint"></a>Hint</h3><p>A brute force solution that attempts to compute an output value for every individual pixel will likely fail due to space or time constraints.</p>
<h2 id="原理与算法"><a href="#原理与算法" class="headerlink" title="原理与算法"></a>原理与算法</h2><p>作为一名新手， 这种算法竞赛题对于我来说是非常困难的，于是我查找了一下其他人的方法，发现了一个比较合理易懂的方法讲解，原文点击<a target="_blank" rel="noopener" href="https://leons.im/posts/poj-1009-edge-detection-report/">这里</a>进行访问。<br>题目中已经提示，不能计算每个像素点的输出值并且拼凑成最后的标准输出，因为对于一些非常大的输入数据会有内存或者运行时间不足的问题。因此，解题时一定需要用某种方式得知每一个“连续段”的信息，换个说法，就是需要知道每个连续段的起始位置（连续段的长度可以由前后两个连续段的起始位置相减得出）。那么我们如何才能根据输入图像得到输出图像中每个连续段的起始位置呢？下面这个定理会告诉我们答案。</p>
<ul>
<li>输出图像中一个连续段的起始格所在的位置一定是至少与输入图像中一个连续段的起始格所相邻的。 </li>
</ul>
<p>这里的相邻表示处在周围9个位置的其中一个。对于图像的中间位置（一般情况），这个定理可以轻松地使用反证法证明，下面是一个一般输入图像的例子：</p>
<blockquote>
<p>.    .    .    .   .<br>.   a   b   c   .<br>.   d   x   e   .<br>.   f    g    h  .<br>.    .    .    .    .</p>
</blockquote>
<p>现在前提假设是：x所在的位置是输出图像中一个连续段的起始点，并且满足其周围9个相邻的位置都不是输入图像中连续段的起始点。如果能据此证明原假设是错误的，那么也就证明了上面的定理。<br>由于x周围八个点都不是输入图像连续段的起始点，因此：a=b=c，d=x=e，f=g=h。因此，上述的输入图像可以写成下面的形式：</p>
<blockquote>
<p>.    .    .    .    .   .<br>.   a   a   a   a   .<br>.   d   d   x   d  .<br>.   f    f    f    f   .<br>.    .    .    .    .   .</p>
</blockquote>
<p>其中d=x。因此输出图像中x所在位置的值为max{|a-d|, |d-f|}，x左侧位置的输出像素值为max{|a-d|, |d-f|}，因此在输出图像中x与其左侧两个位置的像素具有相同的值，因此x所在位置不是一个连续段的起始点，这与起始的假设是矛盾的，因此上述的定理得到了证明。既然如此，我们就可以得知输出图像中哪些位置的像素是需要进行计算的：即那些处在输入图像连续段起始点周围9个位置的像素点（只有他们有可能是输出图像连续点的起始点）。这样一来，相比于计算每个像素点的输出值，计算量已经大大减少了。<br>上述的例子只是一般的情况，即讨论的像素点处在图像的中间位置（周围都有其他像素点）。很显然，图像中有一些特殊的位置，例如图像的边缘以及四个顶角的位置，上面的证明似乎不能适用于这些特殊的位置。其实，我们重新观察上面的证明，对于周围9个位置的计算并不是采用空间上的位置关系，完全可以基于位置“索引值”（即将像素点按照从左到右，从上到下的顺序进行编号）进行计算，考虑x处于图像最左侧一列的例子：</p>
<blockquote>
<p>.    .    …   a<br>b   c   …   d<br>x   e   …   f<br>g   h   …   .<br>.    .    …   .</p>
</blockquote>
<p>这个例子的考虑与上述的一般情况是完全相同的。总结来说，x“周围”的9个像素点位置可以用如下这样的索引值代表：{-width-1, width, -width+1, -1, 0,  1,  width-1, width, width+1}（width表示图像宽度）。因此，对于输入图像中任意位置的起始点，我们只需要将上述九个位置记录下来作为输出图像中可能的连续段起始点位置，并进行计算即可。<br>于是我基于上面的一些结论，利用java语言开始进行算法的实现。经过多次修改，仍然一直得到WA的结果。然后，我查询了ICPC算法竞赛网站，找到了该题所用的<a target="_blank" rel="noopener" href="https://icpc-midcentral.us/_static/archives/2000/edge/io.html">测试数据</a>，发现了错误所在。这其实是因为上述的结论存在一定的漏洞，即有一种特殊情况没有涉及，就是讨论的像素点（输出图像连续段的起始点）在图像左下角的情况。考虑下面的输入图像：</p>
<blockquote>
<p>a    a    …   <strong>a</strong><br><strong>a   a</strong>   …  <strong>a<br>x   a</strong>   …   <strong>b</strong></p>
</blockquote>
<p>其中x=a。观察与x相邻的像素点（上述粗体的字符），均不为连续段的起始点，但是x所在的位置却是输出图像连续段的起始点：x所在位置在输出中值为0，x前面一格的位置值为|a-b|。这应该是左下角的特殊位置导致某些“相邻”点不存在的结果。<br>至此，与算法相关的问题已经解决。总结来说，我们需要做的就是利用输入图像中连续段的起始点，得到输出图像中连续段可能的起始点位置，并且计算输出值，判断它们是否的确是起始点，然后再用游程编码的方式进行图像的输出即可。</p>
<h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><p>我的代码关键部分均写在了一个Image类中，如下所示：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line">public <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Image</span> </span>&#123;</span><br><span class="line">        private final Integer width;</span><br><span class="line">        private Integer maxIndex;</span><br><span class="line">        private final ArrayList&lt;Integer[]&gt; info = <span class="keyword">new</span> ArrayList&lt;Integer[]&gt;(); <span class="comment">// 用于储存连续段信息的ArrayList</span></span><br><span class="line">        private final Integer[] defaultNeighInd;</span><br><span class="line"></span><br><span class="line">        public <span class="function"><span class="title">Image</span>(<span class="params">Integer width</span>)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.width = width;</span><br><span class="line">            defaultNeighInd = <span class="keyword">new</span> Integer[]&#123;-width - <span class="number">1</span>, -width, -width + <span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, width - <span class="number">1</span>, width, width + <span class="number">1</span>&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        public <span class="keyword">void</span> <span class="function"><span class="title">setMaxIndex</span>(<span class="params">Integer maxInd</span>)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.maxIndex = maxInd;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        public Integer <span class="function"><span class="title">getMaxIndex</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.maxIndex;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        public <span class="keyword">void</span> <span class="function"><span class="title">addContiPer</span>(<span class="params">int val, int start</span>)</span> &#123;</span><br><span class="line">            <span class="comment">// 此处把连续段长度换成了连续段起始的索引值位置，方便后续算法</span></span><br><span class="line">            Integer[] conPer = <span class="keyword">new</span> Integer[<span class="number">2</span>];</span><br><span class="line">            conPer[<span class="number">0</span>] = val;</span><br><span class="line">            conPer[<span class="number">1</span>] = start;</span><br><span class="line">            info.add(conPer);</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        public Integer <span class="function"><span class="title">getWidth</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.width;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        public ArrayList&lt;Integer[]&gt; <span class="function"><span class="title">getInfo</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.info;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        public int <span class="function"><span class="title">getValue</span>(<span class="params">int ind</span>)</span> &#123;</span><br><span class="line">            <span class="comment">// 根据一个索引值返回其对应像素的值</span></span><br><span class="line">            int marker = <span class="number">0</span>;</span><br><span class="line">            int val = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (int i = <span class="number">0</span>; i &lt; <span class="built_in">this</span>.info.size(); i++) &#123;</span><br><span class="line">                marker = <span class="built_in">this</span>.info.get(i)[<span class="number">1</span>];</span><br><span class="line">                <span class="keyword">if</span> (marker &gt; ind) &#123;</span><br><span class="line">                    val = <span class="built_in">this</span>.info.get(i - <span class="number">1</span>)[<span class="number">0</span>];</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (val == <span class="number">0</span>) &#123;</span><br><span class="line">                    val = <span class="built_in">this</span>.info.get(<span class="built_in">this</span>.info.size() - <span class="number">1</span>)[<span class="number">0</span>];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> val;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        public Integer[] <span class="function"><span class="title">getNeighInd</span>(<span class="params">int ind</span>)</span> &#123;</span><br><span class="line">            <span class="comment">// 这个函数硬编码了不同特殊位置的像素用于计算输出值的相邻像素</span></span><br><span class="line">            Integer[] neighInds;</span><br><span class="line">            <span class="keyword">if</span> (ind == <span class="number">0</span>) &#123;</span><br><span class="line">                neighInds = <span class="keyword">new</span> Integer[]&#123;<span class="number">1</span>, width, width + <span class="number">1</span>&#125;;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (ind == width - <span class="number">1</span>) &#123;</span><br><span class="line">                neighInds = <span class="keyword">new</span> Integer[]&#123;-<span class="number">1</span>, width - <span class="number">1</span>, width&#125;;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (ind == <span class="built_in">this</span>.maxIndex - <span class="number">1</span>) &#123;</span><br><span class="line">                neighInds = <span class="keyword">new</span> Integer[]&#123;-width - <span class="number">1</span>, -width, -<span class="number">1</span>&#125;;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (ind == <span class="built_in">this</span>.maxIndex - width) &#123;</span><br><span class="line">                neighInds = <span class="keyword">new</span> Integer[]&#123;-width, -width + <span class="number">1</span>, <span class="number">1</span>&#125;;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (ind &lt; width) &#123;</span><br><span class="line">                neighInds = <span class="keyword">new</span> Integer[]&#123;-<span class="number">1</span>, <span class="number">1</span>, width - <span class="number">1</span>, width, width + <span class="number">1</span>&#125;;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (ind % width == <span class="number">0</span>) &#123;</span><br><span class="line">                neighInds = <span class="keyword">new</span> Integer[]&#123;-width, -width + <span class="number">1</span>, <span class="number">1</span>, width, width + <span class="number">1</span>&#125;;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (ind % width == width - <span class="number">1</span>) &#123;</span><br><span class="line">                neighInds = <span class="keyword">new</span> Integer[]&#123;-width, -width - <span class="number">1</span>, -<span class="number">1</span>, width, width - <span class="number">1</span>&#125;;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (ind &gt; <span class="built_in">this</span>.maxIndex - width) &#123;</span><br><span class="line">                neighInds = <span class="keyword">new</span> Integer[]&#123;-width - <span class="number">1</span>, -width, -width + <span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>&#125;;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                neighInds = <span class="built_in">this</span>.defaultNeighInd;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> neighInds;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        public int <span class="function"><span class="title">calcOutPix</span>(<span class="params">int ind</span>)</span> &#123;</span><br><span class="line">            <span class="comment">// 根据一个像素的索引值（位置）计算其输出值</span></span><br><span class="line">            ArrayList&lt;Integer&gt; diffs = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line">            <span class="keyword">for</span> (int i : <span class="built_in">this</span>.getNeighInd(ind)) &#123;</span><br><span class="line">                int neighInd = ind + i;</span><br><span class="line">                <span class="keyword">if</span> (neighInd &gt;= <span class="number">0</span> &amp;&amp; neighInd &lt; <span class="built_in">this</span>.maxIndex) &#123;</span><br><span class="line">                    diffs.add(<span class="built_in">Math</span>.abs(<span class="built_in">this</span>.getValue(ind) - <span class="built_in">this</span>.getValue(neighInd)));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> Collections.max(diffs);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        public Image <span class="function"><span class="title">calcOutIm</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">            <span class="comment">// 返回输出的图像（同样是Image类）</span></span><br><span class="line">            Image outIm = <span class="keyword">new</span> Image(<span class="built_in">this</span>.width);</span><br><span class="line">            HashSet&lt;Integer&gt; indSet = <span class="keyword">new</span> HashSet&lt;Integer&gt;();</span><br><span class="line">            indSet.add(<span class="number">0</span>);</span><br><span class="line">            indSet.add(<span class="built_in">this</span>.maxIndex - <span class="built_in">this</span>.width); <span class="comment">// 这就是前面讨论的特殊点：左下角的像素点</span></span><br><span class="line">    </span><br><span class="line">            <span class="comment">// 得到可能是输出图像中连续段起始位置的像素点索引值</span></span><br><span class="line">            <span class="comment">// 即输入图像中连续段起始点相邻的点</span></span><br><span class="line">            <span class="keyword">for</span> (Integer[] integers : <span class="built_in">this</span>.info) &#123;</span><br><span class="line">                int ind = integers[<span class="number">1</span>];</span><br><span class="line">                indSet.add(ind);</span><br><span class="line">                <span class="keyword">for</span> (int j : <span class="built_in">this</span>.defaultNeighInd) &#123;</span><br><span class="line">                    int neighInd = ind + j;</span><br><span class="line">                    <span class="keyword">if</span> (neighInd &gt;= <span class="number">0</span> &amp;&amp; neighInd &lt; <span class="built_in">this</span>.maxIndex) &#123;</span><br><span class="line">                        indSet.add(neighInd);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            ArrayList&lt;Integer&gt; indNeedCalc = <span class="keyword">new</span> ArrayList&lt;Integer&gt;(indSet);</span><br><span class="line">            Collections.sort(indNeedCalc);</span><br><span class="line">            outIm.addContiPer(<span class="built_in">this</span>.calcOutPix(<span class="number">0</span>), <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">for</span> (int possStart : indNeedCalc) &#123;</span><br><span class="line">                int outVal = <span class="built_in">this</span>.calcOutPix(possStart);</span><br><span class="line">                <span class="keyword">if</span> (possStart != <span class="number">0</span> &amp;&amp; outVal != <span class="built_in">this</span>.calcOutPix(possStart - <span class="number">1</span>)) &#123;</span><br><span class="line">                    outIm.addContiPer(outVal, possStart);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> outIm;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>其中两个关键的函数是calcOutPix(int)与calcOutIm()。前者返回指定位置像素点的输出值，是基于getValue(int)函数（根据位置返回像素点的值）实现的；后者直接返回相应的Image类的输出图像，其中便包含了前述的：找到可能的输出图像连续段起始点的位置，并计算它们的输出值，判断是否为起始点，并生成一个用于返回的Image类输出图像。<br>相应的main函数以及其他的一些具体实现方法可以访问我的<a target="_blank" rel="noopener" href="https://github.com/ZhexuanLei/POJ">github仓库</a>。<br>感谢你的阅读，希望能够提出宝贵意见！</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/POJ/" rel="tag"># POJ</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
            </div>
            <div class="post-nav-item">
                <a href="/2021/06/03/Stoneskipping/" rel="next" title="如何打水漂？">
                  如何打水漂？ <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="valine-comments"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2020 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Marius</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">14k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">13 分钟</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>
  <div class="addthis_inline_share_toolbox">
    <script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-60b8eaac5acd1318" async="async"></script>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  






  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{&quot;enable&quot;:true,&quot;tags&quot;:&quot;none&quot;,&quot;js&quot;:{&quot;url&quot;:&quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;mathjax@3.1.4&#x2F;es5&#x2F;tex-mml-chtml.js&quot;,&quot;integrity&quot;:&quot;sha256-ncNI9OXOS5Ek4tzVYiOMmN&#x2F;KKCPZ6V0Cpv2P&#x2F;zHntiA&#x3D;&quot;}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script>
NexT.utils.loadComments('#valine-comments', () => {
  NexT.utils.getScript('https://unpkg.com/valine@1.4.14/dist/Valine.min.js', () => {
    new Valine(Object.assign({"enable":true,"appId":"vTPObfP47vhcKb1NeM1aijP4-gzGzoHsz","appKey":"O4d1SXHQF6NrhpJbHi9y5x6n","serverURLs":"https://mariuslei.com/","placeholder":"欢迎畅所欲言 ^_^","avatar":"monsterid","meta":["nick","mail","link"],"pageSize":10,"lang":null,"visitor":true,"comment_count":true,"recordIP":false,"enableQQ":false,"requiredFields":[],"notify":false,"verify":false}, {
      el: '#valine-comments',
      path: "/2021/06/02/POJ1009%E6%8A%A5%E5%91%8A/",
      serverURLs: "https://mariuslei.com/"
    }));
  }, window.Valine);
});
</script>

</body>
</html>
